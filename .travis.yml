language: python
python:
  - "3.7"

before_install:
  - >
    [ -f ffmpeg-release/ffmpeg ] || (
        curl -O https://johnvansickle.com/ffmpeg/releases/ffmpeg-release-amd64-static.tar.xz &&
        mkdir -p ffmpeg-release &&
        tar Jxf ffmpeg-release-amd64-static.tar.xz --strip-components=1 -C ffmpeg-release
    )

install:
  - pip install -r requirements.txt

jobs:
  include:
    - stage: "Unit Tests"
      script:
        - export PATH=$(readlink -f ffmpeg-release):$PATH
        - python -m unittest discover -v tests

cache:
  directories:
    - ffmpeg-release